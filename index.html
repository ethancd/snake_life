<html>
<head>
  <meta charset="utf-8">
  <title>Snake/Life</title>

  <link href='/snake_life/favicon.ico' rel="shortcut icon" type="image/vnd.microsoft.icon">
  <link rel="stylesheet/less" type="text/css" href="style.less">

  <script src="https://cdn.firebase.com/v0/firebase.js"></script>
  <!--script updating check -->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="libs/jquery-1.10.2.min.js"><\/script>')</script>
  <script src="libs/underscore-min.js"></script>
  <script src="libs/less-1.4.1.min.js"></script>
  <script src="ninia.js"></script>
</head>
<body>
  <div class="modal shade gone"></div>

  <header class="wrap">
    <h1><span class="snake">Snake</span> / <span class="life">Life</span></h1>
    <h3 class="personal-high hidden">
      Session: <strong class="high-score">0</strong>
    </h3>
    <h2 class="running-score hidden">
      Score: <strong class="score">0</strong><em class="potential"></em>
    </h2>
    <h2 class="final-score gone">
      Final Score: <strong class="score"></strong>
    </h2>
    <button class="show-scores hidden">High Scores</button>
  </header>

  <section class="wrap">
    <form action="" class="user-name gone">
      <h3>Nice job! <br>Want to add your name<br> to the leaderboard?</h3>
      <input type="text" placeholder="Screen Name" maxlength="12" value="">
      <input type="submit" value="Save Name">
      <input id="placebo" type="submit" value="Skip">
    </form>

    <div class="modal all-high-scores gone">
      <h2>High Scores</h2>
      <table class="high-scores-table"></table>
    </div>

    <form action="" class="controls info">
      <input type="submit" value="New Game">

      <div>
        <label>
          <input type="radio" name="size" value="12">
          Teensy
        </label><br>
        <label>
          <input type="radio" name="size" value="16">
          Cramped
        </label><br>
        <label>
          <input type="radio" name="size" value="20" checked>
          Normal
        </label><br>
        <label>
          <input type="radio" name="size" value="28">
          Large
        </label>
      </div>

      <div>
        <label>
          <input type="radio" name="timeStep" value="600">
          Claymation
        </label><br>
        <label>
          <input type="radio" name="timeStep" value="400">
          Slow
        </label><br>
        <label>
          <input type="radio" name="timeStep" value="250" checked>
          Medium
        </label><br>
        <label>
          <input type="radio" name="timeStep" value="175">
          Blazing
        </label><br>
        <label>
          <input type="radio" name="timeStep" value="100">
          Ludicrous
        </label>
      </div>

      <div>
        <label>
          <input type="radio" name="quality" value="fancy" checked>
          Fancy
        </label><br>
        <label>
          <input type="radio" name="quality" value="less_fancy">
          Less Fancy
        </label><br>
        <label>
          <input type="radio" name="quality" value="plain">
          Plain
        </label>
      </div>

      <div>
        <label>
          <input type="radio" name="music" value="true">
          Music<img src="images/speaker_three.png">
        </label>
        <br>
        <label>
          <input type="radio" name="music" value="false" checked>
          Mute<img src="images/speaker_none.png">
        </label>
      </div>
    </form>

    <ul></ul>

    <article>
      <p class="instructions info">
        Use the arrow or WASD keys to move your snake around the board collecting 
        apples, while being careful to avoid walls, the snake body, or the fire of life 
        raging around you. You can also click and drag your mouse through spaces to
        toggle whether they're alive -- useful when you need to disrupt a dangerous
        formation.
      </p>
      <p class="instructions info">
        You score more points the longer you stay alive, and get a bonus based on 
        how many tiles are currently alive every time you eat an apple. Also, the 
        faster the speed and smaller the board, the more points you get! 
      </p>
      <p class="instructions info">
        If the game performance starts to lag, I've found the following to help:
      </p>
      <ol class="instructions info">
        <li>Use the Chrome browser</li>
        <li>Lower the Quality</li>
        <li>Lower the Speed</li>
        <li>Lower the Map Size</li>
      </ol>
      <p class="instructions info">
        Press Enter to start a new game with current settings.
      </p>

      <div class="audio hidden">
        <audio controls loop class="song">
          <source src="audio/dan143.mp3" type="audio/mpeg">
          <source src="audio/dan143.ogg" type="audio/ogg">
          Your browser does not support this audio format.
        </audio>
        <a href="http://danbartonmusic.com/">
          &quot;Massive Pixel Attack&quot; by Dan Barton
        </a>
      </div>
      <div class="audio gone">
        <audio class="sfx">
          <source src="audio/scratch.mp3" type="audio/mpeg">
          <source src="audio/scratch.ogg" type="audio/ogg">
          Your browser does not support this audio format.
        </audio>
      </div>
    </article>
  </section>
  <script>
  $(function(){
    var song = $(".song")[0];
    song.volume = 0.5;

    var blink = function(){
      $(".modal").addClass("gone");
      $(".shade").off();
    };

    var escapeHtml = function(str) {
      var div = document.createElement('div');
      div.appendChild(document.createTextNode(str));
      return div.innerHTML;
    };

    $("html").on("keypress", function(event){
      if (event.keyCode == 13){
        $("form.controls").submit();
      }
    })

    $("button.show-scores").on("click", function(){
      $(".modal").removeClass("gone");
      $(".shade").on("click", function(){
        blink();
      })
    })

    $("form.user-name").on("keypress", function(event){
      if (event.keyCode == 13) {
        event.preventDefault();
        $("form.user-name").submit();
      }
    });

    $("form.user-name").on("submit", function(event){
      event.preventDefault();
      $("form.user-name").addClass("gone");
      $(".shade").addClass("gone");
      unsafeStr = $("input[type=text]").val();
      snakeUserName = escapeHtml(unsafeStr);
      if (snakeUserName === ""){
        snakeUserName = "Anonymous";
      }
      game.postHighScore();
      game = null;
    })

    $("form.controls").on("submit", function(event){
      event.preventDefault();
      blink();
      var quality = $('input[name=quality]:checked').val();
      var size = $('input[name=size]:checked').val();
      var timeStep = $('input[name=timeStep]:checked').val();
      var music = $('input[name=music]:checked').val() == "true" ? true : false;
      
      Program.start(size, timeStep, quality, music);
    }) 
  })
  </script>
</body>
</html>
